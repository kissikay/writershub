<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>User Page</h1>
    <form >
        <input type="text" name="username" id="username" placeholder="username"><br>
        <input type="email" name="email" id="email" placeholder="email"><br>
        <input type="radio" name="gender" id="m" value="m"> Male <br>
        <input type="radio" name="gender" id="f" value="f"> Female <br>
        <input type="date" name="dob" id="dob" placeholder="Date of Birth"><br>
        <input type="password" name="password" id="password" placeholder="password"><br>
        <button type="button" id="register">Submit</button>
    </form>
    <script>
        const btn=document.querySelector("button#register");
        btn.addEventListener("click", async (e)=>{
            e.preventDefault();
            const username= document.querySelector('input#username').value;
            const password= document.querySelector("input#password").value;
            const email= document.querySelector("input#email").value;
            const gender= document.querySelector("input[name='gender']:checked").value;
            const dob= document.querySelector("input#dob").value;
            const pid= Number(Date.now());
            const id= `u${pid}`;
            console.log(id, username, password, dob, gender, email)
            const data={"id":id,"username":username,"dob":dob,"gender":gender,"email":email,"password":password}
            console.log(data);
            try{
            const response = await fetch("/user/register",{
                method:"POST",
                headers:{
                    "Content-Type":"application/json"
                },
                body:JSON.stringify(data),
            });
            if(!response.ok){
                throw new Error(`HTTP error! status :${response.status} message:${response.body}`)
            }

            const result=await response.json();
            if(result.status==="success"){
                window.location.href="/user/account"
            }
                console.log("message:",result.message)
        }catch(err){
            console.log(err)
        }
        })

    </script>
</body>
</html>